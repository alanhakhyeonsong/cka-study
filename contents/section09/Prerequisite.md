## Switching Routing
### 스위치(Switch)
- 동일한 네트워크 내 호스트들을 연결
- 각 호스트는 물리적/가상 인터페이스로 스위치에 연결
- 리눅스 명령어
  - `ip link` : 인터페이스 확인
  - `ip addr` : IP 주소 할당/조회

### 라우터(Router)
- 서로 다른 네트워크 간 통신을 중개
- 라우터는 여러 네트워크 인터페이스와 각각의 IP를 가짐
- 라우터가 없으면 한 네트워크에서 다른 네트워크로 통신 불가

### 게이트웨이(Gateway)
- 라우터의 역할 중 하나
- 네트워크의 "문" 역할
- 호스트는 목적지 네트워크로 가는 "문"을 라우팅 테이블에 설정
- 리눅스 명령어
  - `ip route` : 라우팅 테이블 보기
  - `ip route add` : 새 경로 추가
- 예시
  - 다른 네트워크 접근 위해 게이트웨이 추가
  - `ip route add 192.168.2.0/24 via 192.168.1.1`

### 기본 게이트웨이(Default Gateway)
- "모르는 모든 목적지" 트래픽을 보내는 라우터
- `0.0.0.0/0` 경로를 게이트웨이로 지정
  - `ip route add default via <gateway-ip>`
- 여러 라우터가 있을 수 있음
  - 내부(사설) 네트워크용
  - 인터넷(공용) 네트워크용

### 라우팅 테이블
- 목적지 네트워크 → 게이트웨이 매핑
- 올바른 경로 없으면 패킷 전달 실패
- 문제 해결 시 라우팅 테이블 확인이 중요

### 리눅스 머신을 라우터로 설정하기
- 두 네트워크 인터페이스 가진 호스트가 라우터 역할
- 예: Host B가 A와 C의 네트워크를 연결
- 각 호스트의 라우팅 테이블에 B를 게이트웨이로 추가
- 기본 문제
  - 리눅스는 기본적으로 패킷 포워딩 비활성화
  - 활성화 : `sysctl -w net.ipv4.ip_forward=1`
  - 영구 적용 : `/etc/sysctl.conf`에 추가
    - `net.ipv4.ip_forward=1`

- 스위치는 같은 네트워크 내 통신을 연결하고, 라우터/게이트웨이는 다른 네트워크 간 통신을 연결.
- 리눅스에서는 명령어를 통해 직접 IP와 라우팅 테이블을 설정해 볼 수 있음.
- 포워딩 기능을 켜면 리눅스 호스트가 라우터 역할 가능.

## DNS
### 이름 해상도 기본 개념
- 컴퓨터끼리 통신은 IP 주소로 하지만 사람이 기억하기 어려움
- → 이름(호스트명) ↔ IP 주소 변환 필요
- 이를 이름 해상도(Name Resolution) 라고 함

### /etc/hosts 파일
- 가장 간단한 이름 해상도 방법
- 각 시스템이 로컬 파일을 참조해 이름을 IP로 변환
- 예: `192.168.1.11  db`
- 장점: 간단, 소규모 네트워크에서 유용
- 단점
  - 시스템별로 모두 수동 관리 필요
  - IP 변경 시 모든 서버 수정 필요
  - 중앙 관리 불가
- `/etc/hosts`는 신뢰하지 않아도 무조건 사용 → 거짓 정보도 가능

### DNS 서버
- 중앙 관리형 이름 해상도 서비스
- 모든 호스트가 DNS 서버에 질의 → IP를 반환
- 서버의 IP 변경 시 DNS 서버만 수정하면 됨
- 클라이언트는 `/etc/resolv.conf`에 DNS 서버 IP 지정
  - `nameserver 192.168.1.100`

이름 서버를 여러 개 지정 가능

### 이름 해상도 순서
- 호스트가 이름을 해석할 때 순서:
  - 보통 `/etc/hosts` → DNS
  - 순서는 `/etc/nsswitch.conf`에서 지정
- `/etc/hosts`에 있으면 무조건 우선

### 검색 도메인(search domain)
- `/etc/resolv.conf`의 search 항목
  - 간단한 이름 → FQDN으로 자동 완성
    - eg: `search mycompany.com`
    - `ping web` → 실제 질의는 `web.mycompany.com`

### 도메인 이름 구조
- 계층적(트리 구조)
- 예: `www.google.com`
  - `com` : 최상위 도메인(TLD)
  - `google` : 도메인
  - `www` : 서브도메인
- 하위 도메인으로 서비스 구분 가능
  - `mail`, `drive`, `maps` 등

### DNS 레코드 유형
- A : 이름 → IPv4
- AAAA : 이름 → IPv6
- CNAME : 이름 → 이름(별칭)
  - eg: `orders.mycompany.com → app.mycompany.com`

### DNS 서버의 계층적 구조
- 루트 서버 → TLD 서버 → 권한 서버 → 응답
- 조직도 자체 DNS 서버를 운영 가능
  - 내부 서비스 이름 관리
  - 외부 요청은 공용 DNS 서버(8.8.8.8 등)로 전달

### 주요 명령어
- `ping` : 이름 해상도 + 네트워크 연결 확인
- `nslookup` : DNS 서버 조회 (로컬 hosts는 무시)
- `dig` : 상세한 DNS 쿼리 결과 제공

```
nslookup www.google.com
dig www.google.com
```

정리하자면,
- 소규모 환경 → /etc/hosts로 수동 관리
- 규모 커지면 → 중앙 DNS 서버 필요
- 리눅스는 /etc/resolv.conf, /etc/nsswitch.conf로 DNS 클라이언트 설정